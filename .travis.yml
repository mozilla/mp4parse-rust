language: rust
rust:
  - stable
  - nightly

os:
  - linux
  - osx

before_install:
  # Work around https://github.com/travis-ci/travis-ci/issues/8826, when that
  # issue is fixed we can just include gcc in the addons
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew cask uninstall oclint; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install gcc@5; fi
  
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-5

env:
  global:
    - CXX=g++-5

script:
  - cargo test --all --verbose
  - cargo doc --package mp4parse_capi
